<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            background-color: #2a0033; 
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial', sans-serif;
            color: #333;
        }

        .studio-container {
            text-align: center;
            position: relative;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ffb280, #00c2cb, #ffcce6); 
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-transform: uppercase;
        }

        .logo {
            width: 200px;
            height: 200px;
            margin: 0 auto 2rem;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            background-color: #2a0033; 
            transition: transform 0.3s ease;
            animation: pulse 3s infinite ease-in-out;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .logo::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -100%;
            width: 50%;
            height: 200%;
            background: linear-gradient(
                to right,
                rgba(255,255,255,0) 0%,
                rgba(255,255,255,0.3) 50%,
                rgba(255,255,255,0) 100%
            );
            transform: rotate(30deg);
            transition: all 0s;
            z-index: 1;
            animation: sheen 5s infinite ease-in-out;
        }

        .logo:hover::before {
            left: 200%;
            transition: all 0.7s ease-in-out;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
            }
            50% {
                box-shadow: 0 0 15px rgba(0, 194, 203, 0.5);
            }
            100% {
                box-shadow: 0 0 10px rgba(255, 182, 193, 0.5);
            }
        }

        @keyframes sheen {
            0% { left: -100%; }
            40% { left: -100%; }
            100% { left: 200%; }
        }

        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 1s ease-out forwards 1s;
            color: #00c2cb; 
            position: relative;
            width: 100%;
            height: 1.5rem;
            overflow: visible;
            margin-top: 0.5rem;
        }

        .word-container {
            display: inline-block;
            position: relative;
            width: auto;
            height: 1.375rem;
            vertical-align: bottom;
            transition: width 1s ease-in-out;
        }

        .word {
            position: absolute;
            white-space: nowrap;
            left: 0;
            top: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .visible {
            opacity: 1;
        }

        .hidden {
            opacity: 0;
        }

        .static-text {
            display: inline-block;
            transition: margin 1s ease-in-out;
        }

        #innovation {
            color: #ffb280; 
        }
        
        #imagination {
            color: #ffcce6; 
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .orbit-image {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            z-index: -1;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .hyperspace-mode {
            background-color: #000 !important;
            transition: background-color 0.5s ease;
            perspective: 1000px;
        }
        
        .hyperspace-mode .logo,
        .hyperspace-mode h1,
        .hyperspace-mode .tagline,
        .hyperspace-mode .static-text,
        .hyperspace-mode #innovation,
        .hyperspace-mode #imagination {
            filter: brightness(1.5);
            animation: hyperspace-flash 1s infinite alternate !important;
            z-index: 2;
        }
        
        .hyperspace-mode .orbit-image {
            opacity: 0.7 !important;
            transform: scale(0.5) !important;
            animation: hyperspace-zoom 3s infinite linear !important;
        }
        
        @keyframes hyperspace-flash {
            from { filter: brightness(1.2) blur(0px); }
            to { filter: brightness(1.7) blur(0.5px); }
        }
        
        @keyframes hyperspace-zoom {
            0% { transform: scale(0.3) translateZ(0); }
            100% { transform: scale(1.5) translateZ(0); }
        }
        
        .star {
            position: absolute;
            background-color: white;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 0;
            z-index: 1;
        }
        
        .hyperspace-mode .star {
            opacity: 1;
            animation: none;
            border-radius: 0;
        }
        
        .wormhole-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            perspective: 1000px;
            z-index: -1;
            display: none;
        }
        
        .hyperspace-mode .wormhole-container {
            display: block;
        }
        
        .star-streak {
            position: absolute;
            background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.6) 50%, rgba(255,255,255,0) 100%);
            height: 3px;
            transform-origin: center center;
            opacity: 0;
        }
        
        .hyperspace-mode .star-streak {
            animation: streak-animation 4s linear infinite;
        }
        
        @keyframes streak-animation {
            0% {
                transform: translateZ(-800px) scale(0.1);
                opacity: 0;
            }
            10% {
                opacity: 0.4;
            }
            70% {
                opacity: 0.4;
            }
            100% {
                transform: translateZ(800px) scale(2);
                opacity: 0;
            }
        }
        
        .hyperspace-mode .logo {
            animation: hyperspace-flash 1s infinite alternate, spin 1.5s linear infinite !important;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.7), 0 0 30px rgba(255, 107, 0, 0.7), 0 0 40px rgba(0, 194, 203, 0.7) !important;
            position: relative;
            z-index: 10;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spark {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            filter: blur(1px);
            pointer-events: none;
            z-index: 9;
        }

        .instruction-text {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: #00c2cb;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1rem;
            text-align: center;
            z-index: 100;
            opacity: 0;
            box-shadow: 0 0 15px rgba(0, 194, 203, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.3);
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        
        .instruction-text span {
            display: block;
            margin-bottom: 5px;
        }
        
        .instruction-arrow {
            display: block;
            margin: 8px auto 0;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 15px solid #00c2cb;
            filter: drop-shadow(0 0 5px rgba(0, 194, 203, 0.7));
            animation: pulse-arrow 1.5s infinite ease-in-out;
        }
        
        @keyframes pulse-arrow {
            0% { transform: translateY(0); opacity: 0.7; }
            50% { transform: translateY(10px); opacity: 1; }
            100% { transform: translateY(0); opacity: 0.7; }
        }

        .audio-visualizer {
            position: absolute;
            bottom: 120px;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 5;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        #left-visualizer {
            left: 25%;
        }

        #right-visualizer {
            left: 75%;
        }
        
        .visualizer-container {
            width: 200px;
            height: 70px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .visualizer-circle {
            position: absolute;
            border-radius: 50%;
            border: 2px solid;
            opacity: 0.7;
            transform: scale(0);
            transition: transform 0.2s ease-out;
        }
        
        .visualizer-core {
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #ffcce6, #00c2cb);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
            animation: pulse 2s infinite alternate;
        }
        
        .bass-circle {
            width: 60px;
            height: 60px;
            border-color: #ff6b00;
            box-shadow: 0 0 10px #ff6b00;
        }
        
        .mid-circle {
            width: 100px;
            height: 100px;
            border-color: #00c2cb;
            box-shadow: 0 0 10px #00c2cb;
        }
        
        .treble-circle {
            width: 140px;
            height: 140px;
            border-color: #ffcce6;
            box-shadow: 0 0 10px #ffcce6;
        }
        
        .hyperspace-mode .audio-visualizer {
            opacity: 1;
        }
        
        .visualizer-element {
            display: none;
        }
        
        .comet {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, white 10%, rgba(255, 255, 255, 0.7) 30%, transparent 70%);
            border-radius: 50%;
            z-index: 3;
            opacity: 0;
            filter: blur(1px);
            box-shadow: 0 0 5px white;
            animation: pulse-comet 2s infinite alternate;
            pointer-events: none;
        }
        
        .comet-tail {
            position: absolute;
            height: 3px;
            background: linear-gradient(to var(--direction, right), 
                transparent, 
                rgba(255, 204, 230, 0.8), 
                rgba(0, 194, 203, 0.8), 
                rgba(255, 107, 0, 0.8));
            z-index: 2;
            border-radius: 2px;
            opacity: 0;
            filter: blur(1.5px);
            transform-origin: 0 50%;
            pointer-events: none;
        }
        
        @keyframes pulse-comet {
            0% { transform: scale(0.9); box-shadow: 0 0 5px white; }
            100% { transform: scale(1.1); box-shadow: 0 0 8px white; }
        }
        
        .hyperspace-mode .comet {
            filter: blur(0);
            box-shadow: 0 0 15px white, 0 0 25px #00c2cb;
            width: 12px;
            height: 12px;
            animation: pulse-comet 0.8s infinite alternate;
            background: radial-gradient(circle, white 10%, rgba(255, 255, 255, 0.9) 30%, rgba(0, 194, 203, 0.5) 70%);
        }
        
        .hyperspace-mode .comet-tail {
            filter: blur(0.5px);
            box-shadow: 0 0 8px #00c2cb;
            height: 5px;
            background: linear-gradient(to var(--direction, right), 
                transparent,
                rgba(255, 204, 230, 1), 
                rgba(0, 194, 203, 1), 
                rgba(255, 107, 0, 1));
        }
    </style>
</head>
<body>
    <div class="studio-container">
        <div class="logo">
            <img src="https://greatcreations.github.io/gc3.png" alt="Great Creation Studios Logo">
        </div>
        <h1>Great Creation Studios</h1>
        <p class="tagline">
            <span class="static-text">Where</span> 
            <span id="word-container" class="word-container">
                <span id="innovation" class="word visible">innovation</span>
                <span id="imagination" class="word hidden">imagination</span>
            </span> 
            <span class="static-text">meets creativity for weirdly wonderful creations!</span>
        </p>
    </div>
    <canvas class="particles"></canvas>
    <div id="orbiting-images-container"></div>
    <div id="stars-container"></div>
    <div id="comet-container"></div>
    <div class="wormhole-container" id="wormhole-container"></div>
    <div class="audio-visualizer" id="left-visualizer">
        <div class="visualizer-container">
            <div class="visualizer-circle treble-circle"></div>
            <div class="visualizer-circle mid-circle"></div>
            <div class="visualizer-circle bass-circle"></div>
            <div class="visualizer-core"></div>
        </div>
    </div>
    <div class="audio-visualizer" id="right-visualizer">
        <div class="visualizer-container">
            <div class="visualizer-circle treble-circle"></div>
            <div class="visualizer-circle mid-circle"></div>
            <div class="visualizer-circle bass-circle"></div>
            <div class="visualizer-core"></div>
        </div>
    </div>
    <div id="instruction-container" class="instruction-text">
        <span>Tap for next song</span>
        <span>Double tap to exit</span>
        <div class="instruction-arrow"></div>
    </div>
    <audio id="hyperspace-audio">
        <source src="https://greatcreations.github.io/Waves.wav" type="audio/wav">
        Your browser does not support the audio element.
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let hyperspaceMode = false;
            let longPressTimer;
            let sparkInterval;  
            const body = document.body;
            const starsContainer = document.getElementById('stars-container');
            const wormholeContainer = document.getElementById('wormhole-container');
            const cometContainer = document.getElementById('comet-container');
            const hyperspaceAudio = document.getElementById('hyperspace-audio');
            const instructionContainer = document.getElementById('instruction-container');
            
            const songPlaylist = [
                "https://greatcreations.github.io/Waves.wav",
                "https://greatcreations.github.io/Vision.wav",

                "https://greatcreations.github.io/Spirit.wav",              
                "https://greatcreations.github.io/Noneedforthestress.wav"
            ];
            let currentSongIndex = 0;
            
            hyperspaceAudio.addEventListener('ended', function() {
                currentSongIndex = (currentSongIndex + 1) % songPlaylist.length;
                hyperspaceAudio.src = songPlaylist[currentSongIndex];
                hyperspaceAudio.play().catch(e => console.error("Playback error:", e));
            });

            function createStars() {
                starsContainer.innerHTML = '';
                for (let i = 0; i < 100; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    star.style.left = `${Math.random() * window.innerWidth}px`;
                    star.style.top = `${Math.random() * window.innerHeight}px`;
                    starsContainer.appendChild(star);
                }
            }
            
            function createWormhole() {
                wormholeContainer.innerHTML = '';
                for (let i = 0; i < 50; i++) {
                    const streak = document.createElement('div');
                    streak.classList.add('star-streak');
                    
                    const width = Math.random() * 100 + 100;
                    streak.style.width = `${width}px`;
                    
                    const angle = Math.random() * 360;
                    streak.style.transform = `rotate(${angle}deg)`;
                    
                    streak.style.left = `${Math.random() * window.innerWidth}px`;
                    streak.style.top = `${Math.random() * window.innerHeight}px`;
                    
                    const delay = Math.random() * 4;
                    streak.style.animationDelay = `${delay}s`;
                    
                    wormholeContainer.appendChild(streak);
                }
            }
            
            function clearSparks() {
                if (sparkInterval) {
                    clearInterval(sparkInterval);
                    sparkInterval = null;
                }
                document.querySelectorAll('.spark').forEach(spark => spark.remove());
            }
            
            function createSparks() {
                clearSparks();
                
                const logo = document.querySelector('.logo');
                const logoRect = logo.getBoundingClientRect();
                const centerX = logoRect.left + logoRect.width / 2;
                const centerY = logoRect.top + logoRect.height / 2;
                const radius = logoRect.width / 2;
                
                const logoClickHandler = function(e) {
                    if (hyperspaceMode) {
                        e.preventDefault();
                        e.stopPropagation();
                        playNextSong();
                    }
                };
                
                logo.removeEventListener('click', logoClickHandler);
                logo.removeEventListener('touchend', logoClickHandler);
                logo.addEventListener('click', logoClickHandler);
                logo.addEventListener('touchend', logoClickHandler);
                
                sparkInterval = setInterval(() => {
                    const spark = document.createElement('div');
                    spark.classList.add('spark');
                    document.body.appendChild(spark);
                    
                    const angle = Math.random() * Math.PI * 2;
                    const startDistance = radius;
                    
                    const startX = centerX + Math.cos(angle) * startDistance;
                    const startY = centerY + Math.sin(angle) * startDistance;
                    
                    spark.style.left = `${startX}px`;
                    spark.style.top = `${startY}px`;
                    
                    const colors = ['#ff6b00', '#00c2cb', '#ffebf5', '#ffffff'];
                    spark.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    const size = Math.random() * 15 + 8;
                    spark.style.width = `${size}px`;
                    spark.style.height = `${size}px`;
                    
                    const speed = Math.random() * 5 + 10;
                    const distance = Math.random() * 100 + 50;
                    const duration = distance / speed * 100;
                    
                    spark.animate([
                        { 
                            transform: 'scale(1)', 
                            opacity: 1,
                            left: `${startX}px`,
                            top: `${startY}px`
                        },
                        { 
                            transform: 'scale(0.1)', 
                            opacity: 0,
                            left: `${startX + Math.cos(angle) * distance}px`,
                            top: `${startY + Math.sin(angle) * distance}px`
                        }
                    ], {
                        duration: duration,
                        easing: 'cubic-bezier(0.075, 0.82, 0.165, 1)'
                    }).onfinish = () => {
                        spark.remove();
                    };
                }, 50); 
            }
            
            function animateVisualizer() {
                if (hyperspaceMode) {
                    const bassCircles = document.querySelectorAll('.bass-circle');
                    const midCircles = document.querySelectorAll('.mid-circle');
                    const trebleCircles = document.querySelectorAll('.treble-circle');
                    
                    const bassValue = 0.5 + Math.random() * 0.5;
                    const midValue = 0.4 + Math.random() * 0.6;
                    const trebleValue = 0.3 + Math.random() * 0.7;
                    
                    bassCircles.forEach(circle => circle.style.transform = `scale(${bassValue})`);
                    midCircles.forEach(circle => circle.style.transform = `scale(${midValue})`);
                    trebleCircles.forEach(circle => circle.style.transform = `scale(${trebleValue})`);
                    
                    requestAnimationFrame(animateVisualizer);
                }
            }
            
            function toggleHyperspace() {
                hyperspaceMode = !hyperspaceMode;
                
                if (hyperspaceMode) {
                    body.classList.add('hyperspace-mode');
                    createStars();
                    createWormhole();
                    createSparks();
                    showInstructions();
                    
                    currentSongIndex = 0;
                    hyperspaceAudio.src = songPlaylist[currentSongIndex];
                    hyperspaceAudio.play().catch(error => {
                        console.error("Audio play failed:", error);
                        body.addEventListener('click', function playOnce() {
                            hyperspaceAudio.play();
                            body.removeEventListener('click', playOnce);
                        }, { once: true });
                    });
                    
                    animateVisualizer();
                } else {
                    body.classList.remove('hyperspace-mode');
                    clearSparks();
                    hyperspaceAudio.pause();
                    hyperspaceAudio.currentTime = 0;
                    hideInstructions();
                }
            }
            
            function playNextSong() {
                if (hyperspaceMode) {
                    currentSongIndex = (currentSongIndex + 1) % songPlaylist.length;
                    hyperspaceAudio.src = songPlaylist[currentSongIndex];
                    hyperspaceAudio.play().catch(e => console.error("Play next song failed:", e));
                }
            }
            
            function showInstructions() {
                instructionContainer.style.opacity = '1';
                setTimeout(() => {
                    instructionContainer.style.opacity = '0';
                }, 5000);
            }
            
            function hideInstructions() {
                instructionContainer.style.opacity = '0';
            }
            
            const wordContainer = document.getElementById('word-container');
            const innovation = document.getElementById('innovation');
            const imagination = document.getElementById('imagination');
            const staticTexts = document.querySelectorAll('.static-text');
            
            function toggleWords() {
                if (innovation.classList.contains('visible')) {
                    staticTexts.forEach(text => {
                        text.style.margin = '0 7px';
                    });
                    
                    setTimeout(() => {
                        innovation.classList.remove('visible');
                        innovation.classList.add('hidden');
                        
                        setTimeout(() => {
                            wordContainer.style.width = imagination.offsetWidth + 'px';
                            imagination.classList.remove('hidden');
                            imagination.classList.add('visible');
                        }, 1000);
                    }, 500);
                } else {
                    staticTexts.forEach(text => {
                        text.style.margin = '0';
                    });
                    
                    setTimeout(() => {
                        imagination.classList.remove('visible');
                        imagination.classList.add('hidden');
                        
                        setTimeout(() => {
                            wordContainer.style.width = innovation.offsetWidth + 'px';
                            innovation.classList.remove('hidden');
                            innovation.classList.add('visible');
                        }, 1000);
                    }, 500);
                }
            }
            
            wordContainer.style.width = innovation.offsetWidth + 'px';
            
            setInterval(toggleWords, 5000);
            
            const canvas = document.querySelector('.particles');
            const ctx = canvas.getContext('2d');
            let particles = [];
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 5 + 1;
                    this.speedX = Math.random() * 3 - 1.5;
                    this.speedY = Math.random() * 3 - 1.5;
                    
                    const colors = ['#ff6b00', '#00c2cb', '#ffebf5'];
                    this.color = colors[Math.floor(Math.random() * colors.length)];
                    this.opacity = Math.random() * 0.5 + 0.3;
                }
                
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    
                    if (this.size > 0.2) this.size -= 0.01;
                    
                    if (this.x < 0 || this.x > canvas.width) this.speedX = -this.speedX;
                    if (this.y < 0 || this.y > canvas.height) this.speedY = -this.speedY;
                }
                
                draw() {
                    ctx.fillStyle = this.color;
                    ctx.globalAlpha = this.opacity;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.globalAlpha = 1;
                }
            }
            
            function init() {
                particles = [];
                for (let i = 0; i < 100; i++) {
                    particles.push(new Particle());
                }
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach((particle, index) => {
                    particle.update();
                    particle.draw();
                    
                    if (particle.size <= 0.2) {
                        particles.splice(index, 1);
                        particles.push(new Particle());
                    }
                });
                
                requestAnimationFrame(animate);
            }
            
            init();
            animate();
            
            const orbitingImagesContainer = document.getElementById('orbiting-images-container');
            const imageSources = [
                'https://greatcreations.github.io/gc3.png',
                'https://greatcreations.github.io/gc3.png',
                'https://greatcreations.github.io/gc3.png',
                'https://greatcreations.github.io/gc3.png',
                'https://greatcreations.github.io/gc3.png'
            ];
            
            function createOrbitingImage() {
                const size = Math.random() * 60 + 20;
                
                const img = document.createElement('img');
                img.src = imageSources[Math.floor(Math.random() * imageSources.length)];
                img.className = 'orbit-image';
                img.style.width = `${size}px`;
                img.style.height = `${size}px`;
                
                const startX = Math.random() * window.innerWidth;
                const startY = Math.random() * window.innerHeight;
                
                const radius = Math.random() * 200 + 100;
                const angle = Math.random() * Math.PI * 2;
                const speed = (Math.random() * 0.0005 + 0.0002) * (Math.random() > 0.5 ? 1 : -1);
                const duration = Math.random() * 10000 + 15000;
                
                img.style.left = `${startX}px`;
                img.style.top = `${startY}px`;
                
                orbitingImagesContainer.appendChild(img);
                
                let currentAngle = angle;
                let currentTime = 0;
                let fadeInComplete = false;
                let fadeOutStarted = false;
                
                function animateOrbit() {
                    currentTime += 16;
                    currentAngle += speed;
                    
                    const x = startX + Math.cos(currentAngle) * radius;
                    const y = startY + Math.sin(currentAngle) * radius;
                    
                    img.style.left = `${x}px`;
                    img.style.top = `${y}px`;
                    
                    if (!fadeInComplete && currentTime < 6000) {
                        img.style.opacity = currentTime / 6000;
                    } else if (!fadeInComplete) {
                        img.style.opacity = 1;
                        fadeInComplete = true;
                    }
                    
                    if (!fadeOutStarted && currentTime > duration - 2000) {
                        fadeOutStarted = true;
                    }
                    
                    if (fadeOutStarted) {
                        const fadeOutProgress = (currentTime - (duration - 2000)) / 2000;
                        img.style.opacity = Math.max(0, 1 - fadeOutProgress);
                    }
                    
                    if (currentTime < duration) {
                        requestAnimationFrame(animateOrbit);
                    } else {
                        orbitingImagesContainer.removeChild(img);
                    }
                }
                
                requestAnimationFrame(animateOrbit);
            }
            
            function scheduleNextImage() {
                const delay = Math.random() * 3000 + 2000;
                setTimeout(() => {
                    createOrbitingImage();
                    scheduleNextImage();
                }, delay);
            }
            
            scheduleNextImage();
            
            window.addEventListener('resize', function() {
                resizeCanvas();
                if (hyperspaceMode) {
                    clearSparks();
                    createSparks();
                }
            });
            
            body.addEventListener('dblclick', function(e) {
                if (!e.target.closest('.logo')) {
                    toggleHyperspace();
                }
            });
            
            body.addEventListener('touchstart', function(e) {
                if (!e.target.closest('.logo')) {
                    longPressTimer = setTimeout(function() {
                        toggleHyperspace();
                    }, 800); 
                }
            });
            
            body.addEventListener('touchend', function(e) {
                clearTimeout(longPressTimer);
            });
            
            body.addEventListener('touchmove', function(e) {
                clearTimeout(longPressTimer);
            });
            
            function createComet() {
                cometContainer.innerHTML = '';
                
                const comet = document.createElement('div');
                comet.classList.add('comet');
                
                const cometTail = document.createElement('div');
                cometTail.classList.add('comet-tail');
                
                cometContainer.appendChild(cometTail);
                cometContainer.appendChild(comet);
                
                const leftToRight = Math.random() > 0.5;
                const startX = leftToRight ? -10 : window.innerWidth + 10;
                const endX = leftToRight ? window.innerWidth + 10 : -10;
                
                const startY = Math.random() * (window.innerHeight * 0.8) + (window.innerHeight * 0.1);
                const endY = startY + (Math.random() * 200 - 100);
                
                comet.style.top = `${startY}px`;
                cometTail.style.top = `${startY + 2}px`;
                cometTail.style.setProperty('--direction', leftToRight ? 'right' : 'left');
                
                const duration = hyperspaceMode ? 
                    (Math.random() * 2000 + 2000) : 
                    (Math.random() * 5000 + 7000);
                
                comet.animate([
                    { opacity: 0, left: `${startX}px`, top: `${startY}px` },
                    { opacity: 1, left: `${startX + (leftToRight ? 50 : -50)}px`, top: `${startY + (endY - startY) * 0.25}px` },
                    { opacity: 1, left: `${endX - (leftToRight ? 50 : -50)}px`, top: `${startY + (endY - startY) * 0.75}px` },
                    { opacity: 0, left: `${endX}px`, top: `${endY}px` }
                ], {
                    duration: duration,
                    easing: 'ease-in-out',
                    fill: 'forwards'
                });
                
                cometTail.animate([
                    { opacity: 0, left: `${startX}px`, top: `${startY + 2}px`, width: '0px' },
                    { opacity: 0.9, left: `${startX - (leftToRight ? -5 : 100)}px`, top: `${startY + (endY - startY) * 0.25 + 2}px`, width: '50px' },
                    { opacity: 0.9, left: `${endX - (leftToRight ? 100 : -5)}px`, top: `${startY + (endY - startY) * 0.75 + 2}px`, width: '100px' },
                    { opacity: 0, left: `${endX}px`, top: `${endY + 2}px`, width: '0px' }
                ], {
                    duration: duration,
                    easing: 'ease-in-out',
                    fill: 'forwards'
                }).onfinish = scheduleNextComet;
            }
            
            function scheduleNextComet() {
                const delay = hyperspaceMode ? 
                    (Math.random() * 2000 + 1500) : 
                    (Math.random() * 10000 + 8000);
                
                setTimeout(() => {
                    createComet();
                }, delay);
            }

            scheduleNextComet();
        });
    </script>
</body>
</html>
